<tr id="job-row-{{ job.v_job_id }}"
    x-show="activeTab === 'all' || (activeTab === 'AWO' && '{{ job.v_type }}'.includes('AWO')) || (activeTab === 'DAILY' && '{{ job.v_type }}' === 'DAILY_UPDATE')"
    {% if job.status=='running' %}hx-get="/analytics/backtest/row/{{ job.v_job_id }}" hx-trigger="every 2s"
    hx-swap="outerHTML" {% endif %}>
    <td class="px-6 py-4 whitespace-nowrap">
        <div class="flex flex-col">
            <span class="text-xs font-mono font-bold text-gray-400">#{{ job.v_job_id }}</span>
            <div class="flex items-center gap-1 mt-1">
                {% if 'AWO' in job.v_type %}
                <span class="px-1.5 py-0.5 text-[10px] font-bold rounded bg-indigo-50 text-indigo-600 border border-indigo-100 flex items-center gap-1">
                    <i data-lucide="layers" class="w-2.5 h-2.5"></i> OPT
                </span>
                {% elif job.v_type == 'DAILY_UPDATE' %}
                <span class="px-1.5 py-0.5 text-[10px] font-bold rounded bg-amber-50 text-amber-600 border border-amber-100 flex items-center gap-1">
                    <i data-lucide="refresh-cw" class="w-2.5 h-2.5"></i> OPS
                </span>
                {% else %}
                <span class="px-1.5 py-0.5 text-[10px] font-bold rounded bg-gray-50 text-gray-600 border border-gray-100">
                    {{ job.v_type }}
                </span>
                {% endif %}
            </div>
        </div>
    </td>
    <td class="px-6 py-4 whitespace-nowrap">
        <div class="flex items-center gap-2">
            <span class="font-bold text-sm">{{ job.stock_name }}</span>
            <span class="text-[10px] text-gray-400 font-mono">{{ job.stock_code }}</span>
        </div>
    </td>
    <td class="px-6 py-4 whitespace-nowrap">
        {% if job.status == 'completed' %}
        <span class="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-[10px] font-medium bg-emerald-100 text-emerald-800 text-center leading-tight">
            <i data-lucide="check-circle-2" class="w-3 h-3"></i> Completed <br> 완료
        </span>
        {% elif job.status == 'running' %}
        <span class="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-[10px] font-medium bg-blue-100 text-blue-800 animate-pulse text-center leading-tight">
            <i data-lucide="loader-2" class="w-3 h-3 animate-spin"></i> Running <br> 실행 중
        </span>
        {% elif job.status == 'failed' %}
        <span class="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-[10px] font-medium bg-rose-100 text-rose-800 cursor-help text-center leading-tight"
              title="{{ job.error_message or 'Unknown Error' }}">
            <i data-lucide="alert-circle" class="w-3 h-3"></i> Failed <br> 실패
        </span>
        {% elif job.status == 'stopped' %}
        <span class="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-[10px] font-medium bg-gray-100 text-gray-500 border border-gray-200 text-center leading-tight">
            <i data-lucide="pause-circle" class="w-3 h-3"></i> Stopped <br> 정지
        </span>
        {% else %}
        <span class="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-[10px] font-medium bg-gray-100 text-gray-800 text-center leading-tight">
            <i data-lucide="clock" class="w-3 h-3"></i> Pending <br> 대기
        </span>
        {% endif %}
    </td>
    <td class="px-6 py-4 whitespace-nowrap">
        <div class="w-24 bg-gray-200 rounded-full h-1.5 dark:bg-gray-700">
            <div class="bg-indigo-500 h-1.5 rounded-full transition-all duration-500" style="width: {{ job.progress }}%"></div>
        </div>
        <span class="text-[10px] text-gray-500 mt-1 block">{{ job.progress | round(1) }}%</span>
    </td>
    <td class="px-6 py-4 whitespace-nowrap text-[10px] text-gray-500 font-mono">
        {{ job.started_at | kst if job.started_at else '---' }}
    </td>
    <td class="px-6 py-4 whitespace-nowrap text-right text-sm">
        <div class="flex justify-end items-center gap-2">
            {% if job.status == 'completed' and 'AWO' in job.v_type %}
            <a href="/analytics/expert?stock_code={{ job.stock_code }}&v_job_id={{ job.v_job_id }}"
                class="inline-flex items-center gap-1 px-2 py-1 text-[10px] font-bold text-indigo-600 bg-indigo-50 hover:bg-indigo-100 rounded-md transition-colors text-center leading-tight">
                <i data-lucide="bar-chart-3" class="w-3 h-3"></i> Result <br> 결과
            </a>
            {% endif %}

            {% if job.status == 'pending' %}
            <button hx-post="/analytics/backtest/start/{{ job.v_job_id }}" hx-target="closest tr" hx-swap="outerHTML"
                class="inline-flex items-center gap-1 px-2 py-1 text-[10px] font-bold text-emerald-600 bg-emerald-50 hover:bg-emerald-100 rounded-md transition-colors text-center leading-tight">
                <i data-lucide="play" class="w-3 h-3"></i> Run <br> 실행
            </button>
            {% elif job.status in ('stopped', 'failed') %}
            <button hx-post="/analytics/backtest/restart/{{ job.v_job_id }}" hx-target="closest tr" hx-swap="outerHTML"
                class="inline-flex items-center gap-1 px-2 py-1 text-[10px] font-bold text-amber-600 bg-amber-50 hover:bg-amber-100 rounded-md transition-colors text-center leading-tight">
                <i data-lucide="refresh-cw" class="w-3 h-3"></i> Restart <br> 재시작
            </button>
            {% endif %}

            {% if job.status == 'running' %}
            <button hx-post="/analytics/backtest/stop/{{ job.v_job_id }}" hx-target="closest tr" hx-swap="outerHTML"
                class="inline-flex items-center gap-1 px-2 py-1 text-[10px] font-bold text-rose-600 bg-rose-50 hover:bg-rose-100 rounded-md transition-colors text-center leading-tight">
                <i data-lucide="square" class="w-3 h-3"></i> Stop <br> 정지
            </button>
            {% else %}
            <button hx-delete="/analytics/backtest/{{ job.v_job_id }}" onclick="return confirm('Delete this job record?');"
                hx-trigger="click consume" hx-target="closest tr" hx-swap="outerHTML"
                class="text-gray-400 hover:text-rose-500 transition-colors p-1" title="Delete">
                <i data-lucide="trash-2" class="w-4 h-4"></i>
            </button>
            {% endif %}
        </div>
    </td>
</tr>